<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–°–∫–∞—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ ‚Äî –ú–∏–∫—Ä–æ–∫–ª–∏–º–∞—Ç</title>
  <style>
    :root {
      --primary: #4361ee;
      --success: #06d6a0;
      --danger: #ef476f;
      --warning: #ffd166;
      --light: #f8f9fa;
      --dark: #212529;
      --gray: #6c757d;
      --card-bg: white;
      --shadow: 0 4px 12px rgba(0,0,0,0.08);
      --radius: 16px;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: #f0f4f8;
      color: var(--dark);
      line-height: 1.6;
      padding: 16px;
      max-width: 800px;
      margin: 0 auto;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 24px;
      padding-top: 8px;
    }
    h1 {
      font-size: 1.8em;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .subtitle {
      color: var(--gray);
      font-size: 0.95em;
      flex: 1 1 100%;
    }
    .card {
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 20px;
      margin-bottom: 20px;
    }
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 14px 20px;
      border: 2px solid var(--primary);
      border-radius: 12px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      min-height: 52px;
    }
    .btn-primary {
      background: var(--primary);
      color: white;
    }
    .btn-outline {
      background: transparent;
      color: var(--primary);
    }
    .btn.active {
      background: var(--primary);
      color: white;
    }
    .btn.inactive {
      background: transparent;
      color: var(--primary);
    }
    .btn-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      margin: 16px 0;
    }
    .hint {
      font-size: 0.85em;
      color: var(--gray);
      margin-top: 6px;
      display: block;
    }
    input[type="email"] {
      width: 100%;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin: 8px 0;
    }
    footer {
      text-align: center;
      color: var(--gray);
      font-size: 0.85em;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #eee;
    }
  </style>
</head>
<body>
  <header>
    <div>
      <h1>üì• –°–∫–∞—á–∞—Ç—å –æ—Ç—á—ë—Ç—ã</h1>
      <div class="subtitle">–° –æ—Ç—á—ë—Ç–∞–º–∏ –ø–æ –∑–æ–Ω–∞–º —Ä–∏—Å–∫–∞ (–∫–æ–º—Ñ–æ—Ä—Ç/—Ä–∏—Å–∫/–∫—Ä–∏—Ç–∏—á–Ω–æ)</div>
    </div>
    <a href="help.html" class="btn btn-outline" style="padding:8px 12px; font-size:0.9em;">üìû –ü–æ–º–æ—â—å</a>
  </header>

  <div class="card">
    <h2>1. –ö–∞–∫–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?</h2>
    <div class="btn-group" id="paramButtons">
      <button class="btn btn-outline" data-param="temp">üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</button>
      <button class="btn btn-outline" data-param="hum">üíß –í–ª–∞–∂–Ω–æ—Å—Ç—å</button>
      <button class="btn btn-outline" data-param="lux">‚òÄÔ∏è –û—Å–≤–µ—â—ë–Ω–Ω–æ—Å—Ç—å</button>
      <button class="btn btn-outline" data-param="all">üìä –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</button>
    </div>
    <p id="paramHint" class="hint" style="margin-top:12px; display:none;">
      –í—ã–±—Ä–∞–Ω–æ: <span id="paramName">...</span>
    </p>
  </div>

  <div class="card">
    <h2>2. –ó–∞ –∫–∞–∫–æ–π –ø–µ—Ä–∏–æ–¥ –Ω—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ?</h2>
    <div class="btn-group" id="periodButtons">
      <button class="btn btn-outline" data-period="day">üìÜ –ó–∞ —Å–µ–≥–æ–¥–Ω—è</button>
      <button class="btn btn-outline" data-period="week">üìÖ –ó–∞ –Ω–µ–¥–µ–ª—é</button>
      <button class="btn btn-outline" data-period="month">üìÜ –ó–∞ –º–µ—Å—è—Ü</button>
    </div>
  </div>

  <div class="card">
    <h2>3. –§–æ—Ä–º–∞—Ç –æ—Ç—á—ë—Ç–∞</h2>
    <div class="btn-group">
      <button class="btn btn-outline" onclick="downloadCSV()">üì• CSV</button>
      <button class="btn btn-outline" onclick="downloadPDF()">üìÑ PDF</button>
    </div>

    <div style="margin-top:20px;">
      <label>Email –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç—á—ë—Ç–∞:</label>
      <input type="email" id="reportEmail" placeholder="–≤–∞—à@email.ru">
      <button class="btn btn-success" onclick="sendEmailReport()" style="width:100%;">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ email</button>
    </div>
  </div>

  <div class="card">
    <a href="index.html" class="btn btn-block btn-outline">‚óÄÔ∏è –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É</a>
  </div>

  <footer>
    –û—Ç—á—ë—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç —Ü–≤–µ—Ç–æ–≤—É—é –º–∞—Ä–∫–∏—Ä–æ–≤–∫—É –∑–æ–Ω —Ä–∏—Å–∫–∞.
  </footer>

  <script>
    let selectedParam = null;
    let selectedPeriod = null;
    const paramNames = {
      temp: '–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞',
      hum: '–í–ª–∞–∂–Ω–æ—Å—Ç—å',
      lux: '–û—Å–≤–µ—â—ë–Ω–Ω–æ—Å—Ç—å',
      all: '–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã'
    };

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    document.querySelectorAll('#paramButtons .btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('#paramButtons .btn').forEach(b => b.classList.replace('btn-primary', 'btn-outline'));
        btn.classList.replace('btn-outline', 'btn-primary');
        selectedParam = btn.dataset.param;
        document.getElementById('paramName').textContent = paramNames[selectedParam];
        document.getElementById('paramHint').style.display = 'block';
      });
    });

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –ø–µ—Ä–∏–æ–¥–∞
    document.querySelectorAll('#periodButtons .btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('#periodButtons .btn').forEach(b => b.classList.replace('btn-primary', 'btn-outline'));
        btn.classList.replace('btn-outline', 'btn-primary');
        selectedPeriod = btn.dataset.period;
      });
    });

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è CSV
    function generateCSV() {
      return "timestamp,temp,hum,lux\n1712345600,22.3,48,120\n1712349200,22.5,47,110";
    }

    // –°–∫–∞—á–∞—Ç—å CSV
    function downloadCSV() {
      if (!selectedParam || !selectedPeriod) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –∏ –ø–µ—Ä–∏–æ–¥');
        return;
      }
      const csv = generateCSV();
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `climate_${selectedParam}_${selectedPeriod}.csv`;
      a.click();
      URL.revokeObjectURL(url);
    }

    // –°–∫–∞—á–∞—Ç—å PDF (–∏–º–∏—Ç–∞—Ü–∏—è)
    function downloadPDF() {
      if (!selectedParam || !selectedPeriod) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –∏ –ø–µ—Ä–∏–æ–¥');
        return;
      }
      const content = `–û—Ç—á—ë—Ç –ø–æ –º–∏–∫—Ä–æ–∫–ª–∏–º–∞—Ç—É\n–ü–∞—Ä–∞–º–µ—Ç—Ä: ${paramNames[selectedParam]}\n–ü–µ—Ä–∏–æ–¥: ${selectedPeriod}\n\n–î–∞–Ω–Ω—ã–µ:\n${generateCSV()}`;
      const blob = new Blob([content], { type: 'application/pdf' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `climate_${selectedParam}_${selectedPeriod}.pdf`;
      a.click();
      URL.revokeObjectURL(url);
    }

    // –û—Ç–ø—Ä–∞–≤–∫–∞ email
    function sendEmailReport() {
      if (!selectedParam || !selectedPeriod) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –∏ –ø–µ—Ä–∏–æ–¥');
        return;
      }
      const email = document.getElementById('reportEmail').value;
      if (!email) {
        alert('–£–∫–∞–∂–∏—Ç–µ email');
        return;
      }
      const periods = { day: '01.04.2025 –ø–æ 01.04.2025', week: '01.04.2025 –ø–æ 07.04.2025', month: '01.04.2025 –ø–æ 30.04.2025' };
      const subject = `–û—Ç—á—ë—Ç –ø–æ –º–∏–∫—Ä–æ–∫–ª–∏–º–∞—Ç—É (${paramNames[selectedParam]})`;
      const body =
        `–£–≤–∞–∂–∞–µ–º—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å,\n\n` +
        `ID –¥–∞—Ç—á–∏–∫–∞: CLIM-ABC123\n` +
        `–í—ã—Å—ã–ª–∞—é –æ—Ç—á—ë—Ç –æ—Ç ${periods[selectedPeriod]}.\n\n` +
        `–î–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ CSV:\n` +
        `${generateCSV()}\n\n` +
        `–ö—Ä–∞—Ç–∫–∏–π –∞–Ω–∞–ª–∏–∑:\n‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –¥–æ 58% (–∫—Ä–∏—Ç–∏—á–Ω–æ >55%). –¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è: –ø–ª–∞–≤–Ω–∞—è.\n\n` +
        `–° —É–≤–∞–∂–µ–Ω–∏–µ–º,\n–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–∏–∫—Ä–æ–∫–ª–∏–º–∞—Ç–∞`;

      window.location.href = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    }
  </script>
</body>
</html>